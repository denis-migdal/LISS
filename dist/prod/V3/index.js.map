{"version":3,"file":"index.js","mappings":"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","sources":["webpack://LISS/webpack/runtime/async module","webpack://LISS/./V3/src/utils/encode.ts","webpack://LISS/./V3/src/ContentGenerators/AutoContentGenerator.ts","webpack://LISS/./V3/src/utils/network/ressource.ts","webpack://LISS/./V3/src/ContentGenerators/ContentGenerator.ts","webpack://LISS/./V3/src/signals/SignalEvent.ts","webpack://LISS/./V3/src/signals/ROSignal.ts","webpack://LISS/./V3/src/signals/IndirectSignal.ts","webpack://LISS/./V3/src/signals/Signal.ts","webpack://LISS/./V3/src/LISSClasses/LISSSignal.ts","webpack://LISS/./V3/src/LISS.ts","webpack://LISS/./V3/src/LISSClasses/LISSBase.ts","webpack://LISS/./V3/src/LISSClasses/LISSUpdate.ts","webpack://LISS/./V3/src/define/autoload.ts","webpack://LISS/./V3/src/define/define.ts","webpack://LISS/./V3/src/define/index.ts","webpack://LISS/./V3/src/define/isDefined.ts","webpack://LISS/./V3/src/define/whenDefined.ts","webpack://LISS/./V3/src/index.ts","webpack://LISS/./V3/src/utils/DOM/getPropertyInitialValue.ts","webpack://LISS/./V3/src/utils/DOM/isDOMContentLoaded.ts","webpack://LISS/./V3/src/utils/DOM/isPageLoaded.ts","webpack://LISS/./V3/src/utils/DOM/whenDOMContentLoaded.ts","webpack://LISS/./V3/src/utils/DOM/whenPageLoaded.ts","webpack://LISS/./V3/src/utils/execute/index.ts","webpack://LISS/./V3/src/utils/execute/js.ts","webpack://LISS/./V3/src/utils/network/fetchText.ts","webpack://LISS/./V3/src/utils/network/require.ts","webpack://LISS/./V3/src/utils/parsers/html.ts","webpack://LISS/./V3/src/utils/parsers/index.ts","webpack://LISS/./V3/src/utils/parsers/isTemplateString.ts","webpack://LISS/./V3/src/utils/parsers/style.ts","webpack://LISS/./V3/src/utils/parsers/template.ts","webpack://LISS/./V3/src/utils/tests/assertElement.ts","webpack://LISS/webpack/bootstrap","webpack://LISS/webpack/runtime/define property getters","webpack://LISS/webpack/runtime/hasOwnProperty shorthand","webpack://LISS/webpack/startup"],"sourcesContent":["var webpackQueues = typeof Symbol === \"function\" ? Symbol(\"webpack queues\") : \"__webpack_queues__\";\nvar webpackExports = typeof Symbol === \"function\" ? Symbol(\"webpack exports\") : \"__webpack_exports__\";\nvar webpackError = typeof Symbol === \"function\" ? Symbol(\"webpack error\") : \"__webpack_error__\";\nvar resolveQueue = (queue) => {\n\tif(queue && queue.d < 1) {\n\t\tqueue.d = 1;\n\t\tqueue.forEach((fn) => (fn.r--));\n\t\tqueue.forEach((fn) => (fn.r-- ? fn.r++ : fn()));\n\t}\n}\nvar wrapDeps = (deps) => (deps.map((dep) => {\n\tif(dep !== null && typeof dep === \"object\") {\n\t\tif(dep[webpackQueues]) return dep;\n\t\tif(dep.then) {\n\t\t\tvar queue = [];\n\t\t\tqueue.d = 0;\n\t\t\tdep.then((r) => {\n\t\t\t\tobj[webpackExports] = r;\n\t\t\t\tresolveQueue(queue);\n\t\t\t}, (e) => {\n\t\t\t\tobj[webpackError] = e;\n\t\t\t\tresolveQueue(queue);\n\t\t\t});\n\t\t\tvar obj = {};\n\t\t\tobj[webpackQueues] = (fn) => (fn(queue));\n\t\t\treturn obj;\n\t\t}\n\t}\n\tvar ret = {};\n\tret[webpackQueues] = x => {};\n\tret[webpackExports] = dep;\n\treturn ret;\n}));\n__webpack_require__.a = (module, body, hasAwait) => {\n\tvar queue;\n\thasAwait && ((queue = []).d = -1);\n\tvar depQueues = new Set();\n\tvar exports = module.exports;\n\tvar currentDeps;\n\tvar outerResolve;\n\tvar reject;\n\tvar promise = new Promise((resolve, rej) => {\n\t\treject = rej;\n\t\touterResolve = resolve;\n\t});\n\tpromise[webpackExports] = exports;\n\tpromise[webpackQueues] = (fn) => (queue && fn(queue), depQueues.forEach(fn), promise[\"catch\"](x => {}));\n\tmodule.exports = promise;\n\tbody((deps) => {\n\t\tcurrentDeps = wrapDeps(deps);\n\t\tvar fn;\n\t\tvar getResult = () => (currentDeps.map((d) => {\n\t\t\tif(d[webpackError]) throw d[webpackError];\n\t\t\treturn d[webpackExports];\n\t\t}))\n\t\tvar promise = new Promise((resolve) => {\n\t\t\tfn = () => (resolve(getResult));\n\t\t\tfn.r = 0;\n\t\t\tvar fnQueue = (q) => (q !== queue && !depQueues.has(q) && (depQueues.add(q), q && !q.d && (fn.r++, q.push(fn))));\n\t\t\tcurrentDeps.map((dep) => (dep[webpackQueues](fnQueue)));\n\t\t});\n\t\treturn fn.r ? promise : getResult();\n\t}, (err) => ((err ? reject(promise[webpackError] = err) : outerResolve(exports)), resolveQueue(queue)));\n\tqueue && queue.d < 0 && (queue.d = 0);\n};","const converter = document.createElement('span');\n\nexport default function encodeHTML(text: string) {\n\tconverter.textContent = text;\n\treturn converter.innerHTML;\n}","import { HTML } from \"src/utils/parsers/template\";\nimport ContentGenerator from \"./ContentGenerator\";\nimport encodeHTML from \"src/utils/encode\";\n\nconst regex = /\\$\\{(.+?)\\}/g;\n\nexport default class AutoContentGenerator extends ContentGenerator {\n\n    protected override prepareTemplate(html: HTML) {\n        \n        this.data = null;\n\n        if( typeof html === 'string' ) {\n            this.data = html;\n            return;\n            /*\n            html = html.replaceAll(/\\$\\{([\\w]+)\\}/g, (_, name: string) => {\n                return `<liss value=\"${name}\"></liss>`;\n            });*/\n\n            //TODO: ${} in attr\n                // - detect start ${ + end }\n                // - register elem + attr name\n                // - replace. \n        }\n        \n        super.prepareTemplate(html);\n    }\n\n    override fillContent(shadow: ShadowRoot) {\n        \n        // https://stackoverflow.com/questions/29182244/convert-a-string-to-a-template-string\n        if( this.data !== null) {\n            const str = (this.data as string).replace(regex, (_, match) => {\n                const value = shadow.host.getAttribute(match);\n                if( value === null)\n                    return ''; \n                return encodeHTML(value);\n            });\n\n            super.prepareTemplate(str);\n        }\n\n        super.fillContent(shadow);\n\n        /*\n        // html magic values could be optimized...\n        const values = content.querySelectorAll('liss[value]');\n        for(let value of values)\n            value.textContent = host.getAttribute(value.getAttribute('value')!)\n        */\n    }\n}","export type Ressource<T> =\n      T\n    | Promise<T>\n    | (T extends string         ? Promise<Response> | Response : never)\n    | (T extends Array<infer E> ? Ressource<E>[]               : never);\n\nexport function isRessourceReady<T>(res: Ressource<T>|undefined): res is T|undefined {\n\n    if( Array.isArray(res) )\n        return res.every( e => isRessourceReady(e) );\n\n    return res === undefined || !(res instanceof Promise || res instanceof Response);\n}\n\nexport async function waitRessource<T>(res: Ressource<T>): Promise<T> {\n\n    if( Array.isArray(res) )\n        return await Promise.all(res.map( e => waitRessource(e))) as T;\n\n    if( res instanceof Promise)\n        res = await res;\n\n    if( res instanceof Response)\n        res = await res.text() as T;\n\n    return res as T;\n}","import { isRessourceReady, Ressource, waitRessource } from \"src/utils/network/ressource\";\nimport template, { HTML }   from \"src/utils/parsers/template\";\nimport style   , {CSS}      from \"src/utils/parsers/style\";\nimport isDOMContentLoaded   from \"src/utils/DOM/isDOMContentLoaded\";\nimport whenDOMContentLoaded from \"src/utils/DOM/whenDOMContentLoaded\";\n\ntype STYLE = CSS | CSS[];\n\nexport type ContentGenerator_Opts = {\n    html   ?: Ressource<HTML>,\n    css    ?: Ressource<STYLE>\n}\n\nconst sharedCSS = new CSSStyleSheet();\n//const sharedCSS = getSharedCSS(); // from LISSHost...\n\nexport default class ContentGenerator {\n\n    protected data: any;\n\n    constructor({\n        html,\n        css    = [],\n    }: ContentGenerator_Opts = {}) {\n\n        const isReady = isRessourceReady<HTML> (html)\n                     && isRessourceReady<STYLE>(css)\n                     && isDOMContentLoaded();\n\n        if( isReady )\n            this.prepare(html, css);\n\n        const whenReady: Promise<[HTML|undefined, STYLE|undefined, unknown]> = Promise.all([\n            waitRessource<HTML |undefined>(html),\n            waitRessource<STYLE|undefined>(css),\n            whenDOMContentLoaded()\n        ]);\n\n        whenReady.then( (args) => this.prepare(args[0], args[1]) );\n\n        this.isReady   = isReady;\n        this.whenReady = whenReady;\n    }\n\n    /** ready ***/\n\n    readonly whenReady: Promise<unknown>;\n    readonly isReady  : boolean = false;\n\n    /** process ressources **/\n\n    protected stylesheets: CSSStyleSheet[]       = [];\n    protected template   : DocumentFragment|null = null;\n\n    protected prepare(html: HTML|undefined, css: STYLE|undefined) {\n        if( html !== undefined )\n            this.prepareTemplate(html);\n        if( css  !== undefined )\n            this.prepareStyle   (css);\n    }\n\n    protected prepareTemplate(html: HTML) {\n        this.template = template(html);\n    }\n    protected prepareStyle(css: STYLE) {\n\n        if( ! Array.isArray(css) )\n            css = [css];\n\n        this.stylesheets = css.map(e => style(e) );\n    }\n\n    /*** Generate contents ***/\n\n    initContent(target: HTMLElement, mode:\"open\"|\"closed\"|null) {\n\n        let content: ShadowRoot|HTMLElement = target;\n        if( mode !== null) {\n            content = target.attachShadow({mode});\n            content.adoptedStyleSheets.push(sharedCSS, ...this.stylesheets);\n        }\n        //TODO: CSS for no shadow ???\n        \n        this.fillContent(content);\n\n        return content;\n    }\n\n    fillContent(target: ShadowRoot|HTMLElement|DocumentFragment) {\n        \n        if( this.template !== null)\n            target.replaceChildren( this.createContent() );\n\n        //TODO...\n        customElements.upgrade(target);\n    }\n\n    createContent() {\n        return this.template!.cloneNode(true);\n    }\n}","\nexport default class SignalEvent {\n\n    #callbacks = new Set<(pthis: SignalEvent) => void>();\n\n    listen(callback: (pthis: SignalEvent) => void) {\n        this.#callbacks.add(callback);\n\n        return this;\n    }\n    unlisten(callback: (pthis: SignalEvent) => void) {\n        this.#callbacks.delete(callback);\n\n        return this;\n    }\n\n    protected trigger() {\n\n        for(let callback of this.#callbacks)\n            callback(this);\n\n        return this;\n    }\n}","import SignalEvent from \"./SignalEvent\";\n\nexport default abstract class ROSignal<T> extends SignalEvent {\n\n    override listen(callback: (pthis: SignalEvent) => void) {\n        \n        super.listen(callback);\n\n        callback(this); // initial callback (when signal Data)\n\n        return this;\n    }\n\n    abstract readonly value: T|null;\n}","import ROSignal from \"./ROSignal\";\n\nexport default class IndirectSignal<T = unknown, U = T> extends ROSignal<U> {\n\n    #source: ROSignal<T>|null = null;\n\n    protected _valueRead = false;\n\n    constructor(source: ROSignal<T>|null = null) {\n        super();\n\n        this.#source = source;\n        this.#source?.listen( this._callback );\n    }\n\n    protected override trigger(): this {\n        \n        // no needs to trigger if previous value wasn't read.\n        if( ! this._valueRead )\n            return this;\n\n        this._valueRead = false;\n        super.trigger();\n\n        return this;\n    }\n\n    protected _callback = () => this.trigger();\n\n    get source(): ROSignal<T>|null {\n        return this.#source;\n    }\n\n    set source(source: ROSignal<T>|null) {\n\n        if( this.#source === source ) // nop\n            return;\n\n        if( this.#source !== null)\n            this.#source.unlisten(this._callback);\n\n        this.#source = source;\n\n        if( this.#source !== null)\n           this.#source.listen(this._callback);\n        else\n            this._callback();\n    }\n\n    ack() {\n        this._valueRead = true;\n    }\n\n    override get value(): U|null {\n\n        this.ack();\n\n        if( this.#source === null)\n            return null;\n        return this.#source.value as U|null;\n    }\n}","import IndirectSignal from \"./IndirectSignal\";\nimport ROSignal from \"./ROSignal\";\n\nexport class Signal<T> extends IndirectSignal<T> {\n\n    protected _value: T|null = null;\n\n    constructor(value: T|null = null, source: ROSignal<T>|null = null) {\n        super(source);\n        this._value = value;\n    }\n\n    override set source(source: ROSignal<T>|null) {\n\n        if( source !== null )\n            this._value = null;\n\n        super.source = source; // may trigger if source change\n    }\n\n    override get value() {\n\n        if( this.source !== null)\n            return super.value;\n\n        this.ack();\n        return this._value;\n    }\n\n    override set value(value: T|null) {\n\n        const oldValue = this._value;\n        this._value = value;\n\n        if( this.source !== null ) {\n            this.source = null; // will trigger\n            return;\n        }\n\n        // trigger only if value changed\n        if( value !== oldValue)\n            this.trigger();\n\n        return;\n    }\n}","import { Signal } from \"src/signals/Signal\";\nimport ROSignal   from \"src/signals/ROSignal\";\nimport LISSUpdate from \"./LISSUpdate\";\nimport getPropertyInitialValue from \"src/utils/DOM/getPropertyInitialValue\";\n\n//TODO: getter ?\n\nexport default class LISSSignal<T> extends LISSUpdate {\n\n    #signal = new Signal<T>();\n\n    #callback = () => this.requestUpdate();\n\n    constructor(value: null|T = null, signal: null|ROSignal<T> = null) {\n        super();\n\n        value  ??= getPropertyInitialValue(this, \"value\" , null);\n        signal ??= getPropertyInitialValue(this, \"source\", null)\n\n        if( value  !== null)\n            this.#signal.value = value;\n        if( signal !== null)\n            this.#signal.source = signal;\n\n        this.#signal.listen( this.#callback );\n    }\n\n    set source(source: ROSignal<T>|null) {\n        this.#signal.source = source;\n    }\n    set value(value: T|null) {\n        this.#signal.value = value;\n    }\n\n}","import ContentGenerator from \"src/ContentGenerators/ContentGenerator\";\nimport LISSFull         from \"src/LISSClasses/LISSFull\";\n\ntype Cstr<T> = new(...args:any[]) => T\ntype LISSv3_Opts<T extends Cstr<ContentGenerator> > = {\n    content_generator: T,\n} & ConstructorParameters<T>[0];\n\n//  builder\nexport function LISS<T extends Cstr<ContentGenerator> = Cstr<ContentGenerator>>(opts: Partial<LISSv3_Opts<T>> = {}) {\n    \n    const content_generator = opts.content_generator ?? ContentGenerator;\n    // @ts-ignore\n    const generator: ContentGenerator = new content_generator(opts);\n    \n    return class _LISS<T = void> extends LISSFull<T> {\n\n        // TODO: no content if... ???\n        // override attachShadow  ???\n        static override readonly SHADOW_MODE       = \"open\";\n        static override readonly CONTENT_GENERATOR = generator;\n\n    }\n}\n\n// used for plugins.\nexport class ILISS {}\nexport default LISS as typeof LISS & ILISS;","import ContentGenerator from \"src/ContentGenerators/ContentGenerator\";\n\nexport default class LISSBase extends HTMLElement {\n\n    static readonly SHADOW_MODE      : \"open\"|\"closed\"|null = null;\n    // TODO: static cache getter + use static HTML/CSS.\n    static readonly CONTENT_GENERATOR: ContentGenerator|null = null;\n\n    readonly content  : ShadowRoot|HTMLElement        = this;\n    readonly host     : HTMLElement                   = this;\n    readonly controler: Omit<this, keyof HTMLElement> = this;\n\n    constructor() {\n        super();\n\n        const klass = this.constructor as typeof LISSBase;\n\n        if( klass.CONTENT_GENERATOR !== null )\n            this.content = klass.CONTENT_GENERATOR.initContent(this, klass.SHADOW_MODE);\n    }\n\n\n    // define for auto-complete.\n    static observedAttributes: string[] = [];\n    attributeChangedCallback(name: string, oldval: string|null, newval: string|null){}\n}","import LISSBase from \"./LISSBase\";\n\nexport default class LISSUpdate extends LISSBase {\n\n    constructor() {\n        super();\n\n        observer.observe(this);\n    }\n\n    #requestID: null|number = null;\n    #updateRequested = false;\n    #isVisible       = false;\n\n    static processIntersectionObserver(entries: IntersectionObserverEntry[]) {\n\n        for(let i = 0; i < entries.length; ++i) {\n\n            const target     = entries[i].target as LISSUpdate;\n            const isVisible  = entries[i].isIntersecting;\n\n            target.#isVisible = isVisible;\n\n            if( ! isVisible && target.#requestID !== null)\n                cancelAnimationFrame(target.#requestID);\n\n            if( isVisible && target.#updateRequested && target.#requestID === null )\n                target.#scheduleUpdate();\n        }\n    }\n\n    #scheduleUpdate() {\n        this.#requestID = requestAnimationFrame( () => {\n            this.#requestID       = null;\n            this.#updateRequested = false;\n            this.onUpdate();\n        });\n    }\n\n    requestUpdate() {\n\n        if( this.#updateRequested )\n            return;\n\n        this.#updateRequested = true;\n\n        if( ! this.#isVisible )\n            return;\n\n        this.#scheduleUpdate();\n    }\n\n    protected onUpdate() {\n\n    }\n}\n\nconst observer = new IntersectionObserver( LISSUpdate.processIntersectionObserver );","import define, { WaitingDefine } from \"src/define/define\";\nimport LISS from \"src\";\nimport AutoContentGenerator from \"src/ContentGenerators/AutoContentGenerator\";\nimport isPageLoaded   from \"src/utils/DOM/isPageLoaded\";\nimport whenPageLoaded from \"src/utils/DOM/whenPageLoaded\";\nimport fetchText      from \"src/utils/network/fetchText\";\nimport execute        from \"src/utils/execute\";\n\nconst script =  document.querySelector<HTMLElement>('script:is([liss-auto],[liss-cdir],[liss-sw])');\n\nexport const LISS_MODE    = script?.getAttribute('liss-mode') ?? null;\nexport const DEFAULT_CDIR = script?.getAttribute('liss-cdir') ?? null;\n\n// TODO: default ?\nconst SW_PATH             = script?.getAttribute('liss-sw') ?? null;\n\nif(LISS_MODE === \"auto-load\" && DEFAULT_CDIR !== null) {\n    if( ! isPageLoaded() )\n        await whenPageLoaded();\n    autoload(DEFAULT_CDIR);\n}\n\nexport function autoload(cdir: string) {\n\n    const SW: Promise<void> = new Promise( async (resolve) => {\n\n        if( SW_PATH === null ) {\n            console.warn(\"You are using LISS Auto mode without sw.js.\");\n            resolve();\n            return;\n        }\n        \n        try {\n            await navigator.serviceWorker.register(SW_PATH, {scope: \"/\"});\n        } catch(e) {\n            console.warn(\"Registration of ServiceWorker failed\");\n            console.error(e);\n            resolve();\n        }\n\n        if( navigator.serviceWorker.controller ) {\n            resolve();\n            return;\n        }\n\n        navigator.serviceWorker.addEventListener('controllerchange', () => {\n            resolve();\n        });\n    });\n\n    if( cdir[cdir.length-1] !== '/')\n        cdir += '/';\n\n    //const brython = script.getAttribute(\"brython\");\n\n    // observe for new injected tags.\n    new MutationObserver( (mutations) => {\n        for(let mutation of mutations)\n            for(let addition of mutation.addedNodes)\n                if( addition.constructor.name === \"HTMLElement\" )\n                // cf https://github.com/WICG/webcomponents/issues/1097#issuecomment-2665092315\n                // if(addition instanceof HTMLUnknownElement)\n                    addTag(addition as HTMLElement)\n\n    }).observe( document, { childList:true, subtree:true });\n\n    for( let elem of document.querySelectorAll<HTMLElement>(\":not(:defined)\") )\n        addTag( elem );\n\n    async function addTag(tag: HTMLElement) {\n\n        await SW; // ensure SW is installed.\n\n        const tagname = tag.tagName.toLowerCase();\n\n        if(  WaitingDefine.has(tagname)\n            // could be defined, but not yet upgraded\n         || customElements.get(tagname) !== undefined)\n            return;\n\n        loadComponent(tagname, {\n            //brython,\n            cdir\n        });\t\t\n    }\n}\n\n/*****/\n\ntype loadComponent_Opts = {\n\tcdir   ?: string|null\n};\n\ntype Cstr<T> = (...args: any[]) => T;\n\nexport async function loadComponent<T extends HTMLElement = HTMLElement>(\n\ttagname: string,\n\t{\n\t\tcdir    = DEFAULT_CDIR,\n\t\t// brython = null\n\t}: loadComponent_Opts = {}\n): Promise<Cstr<T>> {\n\n\tWaitingDefine.add(tagname);\n\n    let true_tagdir = LISSContext?.override_tags?.[tagname] ?? tagname;     \n\n\tconst compo_dir = `${cdir}${true_tagdir}/`;\n\n\tconst files: Record<string,string|undefined> = {};\n\n\t// strats : JS -> Bry -> HTML+CSS (cf script attr).\n\n    files[\"js\"] = await fetchText(`${compo_dir}index.js`, true);\n\n    if( files[\"js\"] === undefined) {\n        // try/catch ?\n        const promises = [\n            fetchText(`${compo_dir}index.html`, true)!,\n            fetchText(`${compo_dir}index.css` , true)!\n        ];\n\n        [files[\"html\"], files[\"css\" ]] = await Promise.all(promises);\n    }\n\n\treturn await defineWebComponent(tagname, files, compo_dir);\n}\n\n//TODO: rename from files ?\nasync function defineWebComponent(tagname: string,\n                                  files: Record<string, any>,\n                                  origin : string,\n                                ) {\n    \n    let klass;\n    if( \"js\" in files )\n        klass = (await execute<any>(files[\"js\"], \"js\", origin)).default;\n\n    if( klass === undefined )\n        klass = LISS({\n            content_generator: AutoContentGenerator,\n            ...files\n        });\n\n    define(tagname, klass);\n\n    return klass;\n}","import ContentGenerator from \"src/ContentGenerators/ContentGenerator\";\nimport { _whenDefinedPromises } from \"./whenDefined\";\n\nexport const WaitingDefine = new Set<string>();\n\nexport default async function define(tagname: string, Klass: new(...args:any[]) => HTMLElement) {\n\n    //TODO: Python class...\n\n    //TODO: type safe\n    if( \"CONTENT_GENERATOR\" in Klass ) {\n        const generator = Klass.CONTENT_GENERATOR as ContentGenerator;\n\n        if( ! generator.isReady ) {\n            WaitingDefine.add(tagname);\n            await generator.whenReady;\n        }\n    }\n\n    WaitingDefine.delete(tagname);\n    customElements.define(tagname, Klass);\n\n    const p = _whenDefinedPromises.get(Klass);\n    if( p !== undefined )\n        p.resolve();\n}\n\nimport LISS from \"src/LISS\";\n\ndeclare module \"src/LISS\" {\n    interface ILISS {\n        define: typeof define;\n    }\n}\n\nLISS.define = define;","import define      from \"./define\";\nimport isDefined   from \"./isDefined\";\nimport whenDefined from \"./whenDefined\";\n\nimport LISS from \"src/LISS\";\n\ndeclare module \"src/LISS\" {\n    interface ILISS {\n        define    : typeof define;\n        isDefined: typeof isDefined;\n        whenDefined   : typeof whenDefined;\n    }\n}\n\nLISS.define      = define;\nLISS.isDefined   = isDefined;\nLISS.whenDefined = whenDefined;\n\nexport {define, isDefined, whenDefined};","export default function isDefined(elem: string|(new(...args:any[])=>HTMLElement)): boolean {\n    \n    if( typeof elem === \"string\")\n        return customElements.get(elem) !== undefined;\n\n    return customElements.getName(elem) !== null;\n}","type Cstr<T> = new(...args:any[])=> T;\n\nexport const _whenDefinedPromises = new WeakMap<Cstr<HTMLElement>, PromiseWithResolvers<void>>();\n\nexport default async function whenDefined<T extends HTMLElement>(elem: string|Cstr<T>): Promise<Cstr<T>> {\n    \n    if( typeof elem === \"string\")\n        return await customElements.whenDefined(elem) as Cstr<T>;\n\n    if( customElements.getName(elem) !== null)\n        return elem as Cstr<T>;\n\n    let p = _whenDefinedPromises.get(elem);\n    if( p === undefined ){\n        p = Promise.withResolvers<void>();\n        _whenDefinedPromises.set(elem, p);\n    }\n\n    await p.promise;\n    return elem;\n}","import LISS from \"src/LISS\";\n\nimport \"src/define\";\nimport \"src/define/autoload\";\n\nimport \"src/utils/parsers\";\nimport \"src/utils/network/require\";\n\nimport \"src/utils/tests/assertElement\";\n\ndeclare module \"src/LISS\" {\n    interface ILISS {\n        VERSION: string\n    }\n}\n\nLISS.VERSION = \"V3\";\n\nexport default LISS;\n\n// @ts-ignore\nglobalThis.LISS = LISS;","export default function getPropertyInitialValue<E extends HTMLElement,\n                                                N extends keyof E,\n                                                D = undefined>\n                                (e: E, name: N, defaultValue?: D): D|E[N] {\n\n    if( ! Object.hasOwn(e, name) )\n        return defaultValue as D;\n\n    const  _ = e[name];\n    delete     e[name];\n    return _;\n}","export default function isDOMContentLoaded() {\n    return document.readyState === \"interactive\" || document.readyState === \"complete\";\n}","export default function isPageLoaded() {\n    return document.readyState === \"complete\"\n}","import isDOMContentLoaded from \"./isDOMContentLoaded\";\n\nexport default async function whenDOMContentLoaded() {\n    if( isDOMContentLoaded() )\n        return;\n\n    const {promise, resolve} = Promise.withResolvers<void>()\n\n\tdocument.addEventListener('DOMContentLoaded', () => {\n\t\tresolve();\n\t}, true);\n\n    await promise;\n}","import isPageLoaded from \"./isPageLoaded\";\n\nexport default async function whenDOMContentLoaded() {\n    if( isPageLoaded() )\n        return;\n\n    const {promise, resolve} = Promise.withResolvers<void>()\n\n\tdocument.addEventListener('load', resolve as any, true);\n\n    await promise;\n}","import executeJS from \"./js\";\n\nexport default async function execute<T>(code: string, type: \"js\", origin: string): Promise<T> {\n\n    if( type === \"js\" )\n        return await executeJS<T>(code, origin);\n\n    throw new Error('');\n}","export default async function executeJS<T>(code: string, origin: string): Promise<T> {\n\n    const file = new Blob([code], { type: 'application/javascript' });\n    const url  = URL.createObjectURL(file);\n\n    const id = url.slice(url.lastIndexOf('/') + 1 );\n    ((globalThis.LISSContext ??={}).execute ??= {url_map: {}}).url_map[id] = origin;\n\n    const result = (await import(/* webpackIgnore: true */ url));\n    \n    URL.revokeObjectURL(url);\n\n    return result as unknown as T;\n}\n\n\ndeclare global {\n\n    interface LISSContext {\n        execute?: {\n            url_map: Record<string, string>\n        }\n    }\n\n    var LISSContext: LISSContext;\n    \n}","// in auto-mode use ServiceWorker to hide 404 error messages.\n// if playground files, use them.\nexport default async function fetchText(uri: string|URL, hide404: boolean = false) {\n\n    const fetchContext = globalThis.LISSContext?.fetch;\n    if( fetchContext !== undefined ) { // for the playground\n        const path = new URL(uri, fetchContext.cwd );\n        const value = fetchContext.files[path.toString()];\n        if( value === \"\" )\n            return undefined;\n        if( value !== undefined)\n            return value;\n    }\n\n    const options = hide404\n                        ? {headers:{\"liss-auto\": \"true\"}}\n                        : {};\n\n\n    const response = await fetch(uri, options);\n    if(response.status !== 200 )\n        return undefined;\n\n    if( hide404 && response.headers.get(\"status\")! === \"404\" )\n        return undefined;\n\n    const answer = await response.text();\n\n    if(answer === \"\")\n        return undefined;\n\n    return answer\n}\n\n\n\ndeclare global {\n\n    interface LISSContext {\n        fetch?: {\n            cwd  : string,\n            files: Record<string, string>\n        }\n    }\n\n    var LISSContext: LISSContext;\n}","import fetchText from \"./fetchText\";\n\n// @ts-ignore\nglobalThis.require = async function(url: string) {\n\n    const stack = new Error().stack!;\n\n    let caller: string;\n    if( stack.startsWith(\"Error\") ) {   // Chrome ?\n        caller = stack.split('\\n')[1+1].slice(7);\n    } else {                            // FF ?\n        caller = stack.split('\\n')[1].slice(1);\n    }\n\n    if( caller.startsWith('blob:') ) {\n\n        caller = caller.slice(caller.lastIndexOf('/') + 1 );\n        caller = caller.slice(0, caller.indexOf(':'));\n\n        url = LISSContext.execute!.url_map[caller] + url;\n        \n        //TODO: rewrite URL...\n    } else {\n        console.warn( caller );\n        throw new Error(\"require from non-blob import, unimplemented\");\n    }\n\n    // TODO: reverify playground\n\n    return await fetchText(url);\n}","import isTemplateString from \"./isTemplateString\";\nimport { Template } from \"./types\";\n\nconst template = document.createElement(\"template\");\nconst df = template.content;\n\nexport default function html<T extends HTMLElement>(...raw: Template<string>): T {\n    \n    let elem: string = raw[0] as any;\n\n    if( isTemplateString(raw) ) {\n        \n        const str = raw[0];\n\n        let string = str[0];\n        for(let i = 1; i < raw.length; ++i) {\n            string += raw[i];\n            string += str[i];\n        }\n\n        elem = string;\n    }\n\n    template.innerHTML = elem;\n\n    if( df.childNodes.length !== 1)\n        throw new Error(\"Error\");\n\n    return df.firstChild as T;\n}","import LISS from \"src/LISS\";\n\nimport html     from \"./html\"\nimport template from \"./template\";\nimport style    from \"./style\";\n\ndeclare module \"src/LISS\" {\n    interface ILISS {\n        html    : typeof html;\n        template: typeof template;\n        style   : typeof style;\n    }\n}\n\nLISS.style    = style;\nLISS.template = template;\nLISS.html     = html;\n\nexport {style, template, html};","export default function isTemplateString(raw: [unknown, ...unknown[]]): raw is [TemplateStringsArray, ...string[]] {\n    return Array.isArray(raw[0]);\n}","import { Template } from \"./types\";\n\nexport type CSS   = string|CSSStyleSheet|HTMLStyleElement;\n\nexport default function style(...raw: Template<CSS>): CSSStyleSheet {\n\n    let elem = raw[0];\n\n    if( elem instanceof CSSStyleSheet )\n        return elem;\n    if( elem instanceof HTMLStyleElement)\n        return elem.sheet!;\n\n    if( Array.isArray(elem) ) {\n        \n        const str = raw[0] as TemplateStringsArray;\n\n        let string = str[0];\n        for(let i = 1; i < raw.length; ++i) {\n            string += raw[i];\n            string += str[i];\n        }\n\n        elem = string;\n    }\n\n    if( typeof elem !== \"string\") {\n        console.warn(elem);\n        console.trace();\n        throw new Error(\"Should not occurs\");\n    }\n\n    const style = new CSSStyleSheet();\n    style.replaceSync(elem);\n    return style;\n}","import isTemplateString from \"./isTemplateString\";\nimport { Template } from \"./types\";\n\nexport type HTML  = DocumentFragment|HTMLElement|string;\n\nexport default function template( ...raw:Template<HTML>): DocumentFragment {\n\n    let elem: HTML = raw[0] as any;\n\n    if( isTemplateString(raw) ) {\n        \n        const str = raw[0];\n\n        let string = str[0];\n        for(let i = 1; i < raw.length; ++i) {\n            string += raw[i];\n            string += str[i];\n        }\n\n        elem = string;\n    }\n\n    if( elem instanceof DocumentFragment )\n        return elem.cloneNode(true) as DocumentFragment;\n\n    // must use template as DocumentFragment doesn't have .innerHTML\n    let template = document.createElement('template');\n\n    if(typeof elem === 'string')\n        template.innerHTML = elem.trim();\n    else {\n        if( elem instanceof HTMLElement)\n            // prevents issue if elem is latter updated.\n            elem = elem.cloneNode(true) as HTMLElement;\n        \n        template.append( elem );\n    }\n\n    //if( template.content.childNodes.length === 1 && template.content.firstChild!.nodeType !== Node.TEXT_NODE)\n    //  return template.content.firstChild! as unknown as T;\n    \n    return template.content!;\n}","import whenDefined from \"src/define/whenDefined\";\n\ntype Options = {\n    shadow_html?: string,\n    css        ?: Record<string, Record<string, string>>\n}\n\nfunction waitFrame() {\n    const { promise, resolve} = Promise.withResolvers<void>();\n\n    requestAnimationFrame( () => resolve() );\n\n    return promise;\n}\n\nexport default async function assertElement(tagname: string, opts: Options = {}) {\n    \n    const shadow_html = opts.shadow_html ?? null;\n    const css         = opts.css         ?? {};\n\n\n    await whenDefined(tagname);\n\n    //for(let i = 0; i < 1; ++i)\n    //    await waitFrame();\n\n    const elem = document.querySelector(tagname);\n\n    if( elem === null )\n        throw new Error(\"Component not found\");\n\n    //TODO: await LISS.whenInitialized(elem); ?\n\n    if( elem.tagName.toLowerCase() !== tagname )\n        throw new Error(\n`Wrong tagname.\nExpected: ${tagname}\nGot: ${elem.tagName.toLowerCase()}`);\n\n    if( elem.constructor.name === \"HTMLElement\")\n        throw new Error(`Element not upgraded!`);\n\n    if( shadow_html !== elem.shadowRoot ) {\n        if( shadow_html === null || elem.shadowRoot === null )\n            throw new Error(`ShadowRoot missing or unexpected.`);\n        if( shadow_html !== elem.shadowRoot.innerHTML )\n            throw new Error(\n`HTML content mismatched.\nExpected: ${shadow_html}\nGot: ${elem.shadowRoot.innerHTML}`);\n    }\n\n    for(let selector in css ) {\n        const expected = css[selector];\n\n        let sub_elems: NodeListOf<HTMLElement>|HTMLElement[];\n        if( selector === \"\")\n            sub_elems = [elem as HTMLElement];\n        else\n            sub_elems = (((elem as any).content ?? elem.shadowRoot ?? elem) as ShadowRoot|HTMLElement).querySelectorAll<HTMLElement>(selector);\n    \n        if( sub_elems.length === 0)\n            throw new Error(`Elements \"${selector}\" not found`);\n\n        for( let sub_elem of sub_elems ) {\n\n            // compare style : https://stackoverflow.com/questions/59342928/getcomputedstyle-only-the-changes-from-default\n            //  ^ get all elements, find matching qs, compare\n            // pseudo class  : https://stackoverflow.com/questions/32091848/template-queryselector-using-scope-pseudo-class-works-with-document-but-not\n\n            const css = getComputedStyle(sub_elem)\n            for(let propname in expected) {\n                const val = css.getPropertyValue(propname);\n                if( val !== expected[propname] ) {\n                        throw new Error(\n        `CSS mismatch\n        Expected:${expected}\n        Got: ${css}`);\n                }\n            }\n        }\n    }\n}\n\nimport LISS from \"src/LISS\";\n\ndeclare module \"src/LISS\" {\n    interface ILISS {\n        assertElement    : typeof assertElement;\n    }\n}\n\nLISS.assertElement = assertElement;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// startup\n// Load entry module and return exports\n// This entry module used 'module' so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(4423);\n"],"names":["webpackQueues","webpackExports","webpackError","resolveQueue","converter","document","createElement","regex","AutoContentGenerator","ContentGenerator","prepareTemplate","html","this","data","super","fillContent","shadow","str","replace","_","match","value","host","getAttribute","text","textContent","innerHTML","isRessourceReady","res","Array","isArray","every","e","undefined","Promise","Response","async","waitRessource","all","map","sharedCSS","CSSStyleSheet","constructor","css","isReady","isDOMContentLoaded","prepare","whenReady","whenDOMContentLoaded","then","args","template","prepareStyle","stylesheets","style","initContent","target","mode","content","attachShadow","adoptedStyleSheets","push","replaceChildren","createContent","customElements","upgrade","cloneNode","SignalEvent","Set","listen","callback","add","unlisten","delete","trigger","ROSignal","IndirectSignal","_valueRead","source","_callback","ack","Signal","_value","oldValue","LISSSignal","LISSUpdate","requestUpdate","signal","getPropertyInitialValue","opts","generator","content_generator","LISSFull","static","LISSBase","HTMLElement","controler","klass","CONTENT_GENERATOR","SHADOW_MODE","attributeChangedCallback","name","oldval","newval","observer","observe","processIntersectionObserver","entries","i","length","isVisible","isIntersecting","cancelAnimationFrame","requestAnimationFrame","onUpdate","IntersectionObserver","script","querySelector","LISS_MODE","DEFAULT_CDIR","SW_PATH","autoload","cdir","SW","resolve","console","warn","navigator","serviceWorker","register","scope","error","controller","addEventListener","MutationObserver","mutations","mutation","addition","addedNodes","addTag","childList","subtree","elem","querySelectorAll","tag","tagname","tagName","toLowerCase","WaitingDefine","has","get","loadComponent","compo_dir","LISSContext","override_tags","files","fetchText","promises","defineWebComponent","origin","execute","default","LISS","define","isPageLoaded","whenPageLoaded","Klass","p","_whenDefinedPromises","isDefined","getName","whenDefined","WeakMap","withResolvers","set","promise","VERSION","globalThis","defaultValue","Object","hasOwn","readyState","code","type","file","Blob","url","URL","createObjectURL","id","slice","lastIndexOf","url_map","result","import","revokeObjectURL","executeJS","Error","uri","hide404","fetchContext","fetch","path","cwd","toString","options","headers","response","status","answer","require","stack","caller","startsWith","split","indexOf","df","raw","isTemplateString","string","childNodes","firstChild","HTMLStyleElement","sheet","trace","replaceSync","DocumentFragment","trim","append","assertElement","shadow_html","shadowRoot","selector","expected","sub_elems","sub_elem","getComputedStyle","propname","getPropertyValue","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","Symbol","queue","d","forEach","fn","r","a","body","hasAwait","currentDeps","outerResolve","reject","depQueues","rej","x","deps","dep","obj","ret","wrapDeps","getResult","fnQueue","q","err","definition","key","o","defineProperty","enumerable","prop","prototype","hasOwnProperty","call"],"sourceRoot":""}